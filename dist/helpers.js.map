{"version":3,"file":"helpers.js","names":["pathToFileURL","build","rmSync","yaml","builtinModules","dotPathToHash","entry","target","arguments","length","undefined","options","conflict","duplicate","path","keyWithNamespace","suffix","separator","key","substring","indexOf","namespace","defaultValue","concat","newValue","value","locale","endsWith","slice","segments","split","inner","i","segment","lastSegment","oldValue","_typeof","customValueTemplate","entries","Object","forEach","valueEntry","replace","mergeHashes","source","resetValues","old","reset","mergeCount","pullCount","oldCount","resetCount","keepRemoved","pluralSeparator","hasNestedEntries","Array","isArray","nested","keys","resetAndFlag","isPlural","singularKey","getSingularForm","pluralMatch","contextRegex","contextMatch","test","rawKey","hasRelatedPluralKey","transferValues","sourceValue","targetValue","pluralSuffixes","some","pluralRegex","RegExp","getPluralSuffixPosition","len","makeDefaultSort","defaultSort","key1","key2","singularKey1","singularKey2","localeCompare","esConfigLoader","_x","_esConfigLoader","apply","_asyncToGenerator","_regeneratorRuntime","mark","_callee","filepath","wrap","_callee$","_context","prev","next","abrupt","sent","stop","tsConfigLoader","_x2","_tsConfigLoader","_callee2","outfile","config","_callee2$","_context2","absWorkingDir","process","cwd","entryPoints","write","platform","bundle","format","sourcemap","external","_toConsumableArray","map","mod","yamlConfigLoader","content","load","unescape","text","matchHtmlEntity","htmlEntities","unescapeHtmlEntity","m"],"sources":["../src/helpers.js"],"sourcesContent":["import { pathToFileURL } from 'url'\r\nimport { build } from 'esbuild'\r\nimport { rmSync } from 'fs'\r\nimport yaml from 'js-yaml'\r\nimport { builtinModules } from 'module'\r\n\r\n/**\r\n * Take an entry for the Parser and turn it into a hash,\r\n * turning the key path 'foo.bar' into an hash {foo: {bar: \"\"}}\r\n * The generated hash can be merged with an optional `target`.\r\n * @returns An `{ target, duplicate, conflict }` object. `target` is the hash\r\n * that was passed as an argument or a new hash if none was passed. `duplicate`\r\n * indicates whether the entry already existed in the `target` hash. `conflict`\r\n * is `\"key\"` if a parent of the key was already mapped to a string (e.g. when\r\n * merging entry {one: {two: \"bla\"}} with target {one: \"bla\"}) or the key was\r\n * already mapped to a map (e.g. when merging entry {one: \"bla\"} with target\r\n * {one: {two: \"bla\"}}), `\"value\"` if the same key already exists with a\r\n * different value, or `false`.\r\n */\r\nfunction dotPathToHash(entry, target = {}, options = {}) {\r\n  let conflict = false\r\n  let duplicate = false\r\n  let path = entry.keyWithNamespace\r\n  if (options.suffix) {\r\n    path += options.suffix\r\n  }\r\n\r\n  const separator = options.separator || '.'\r\n\r\n  const key = entry.keyWithNamespace.substring(\r\n    entry.keyWithNamespace.indexOf(separator) + separator.length,\r\n    entry.keyWithNamespace.length\r\n  )\r\n\r\n  // There is no key to process so we return an empty object\r\n  if (!key) {\r\n    if (!target[entry.namespace]) {\r\n      target[entry.namespace] = {}\r\n    }\r\n    return { target, duplicate, conflict }\r\n  }\r\n\r\n  const defaultValue =\r\n    entry[`defaultValue${options.suffix}`] || entry.defaultValue || ''\r\n\r\n  let newValue =\r\n    typeof options.value === 'function'\r\n      ? options.value(options.locale, entry.namespace, key, defaultValue)\r\n      : options.value || defaultValue\r\n\r\n  if (path.endsWith(separator)) {\r\n    path = path.slice(0, -separator.length)\r\n  }\r\n\r\n  const segments = path.split(separator)\r\n  let inner = target\r\n  for (let i = 0; i < segments.length - 1; i += 1) {\r\n    const segment = segments[i]\r\n    if (segment) {\r\n      if (typeof inner[segment] === 'string') {\r\n        conflict = 'key'\r\n      }\r\n      if (inner[segment] === undefined || conflict) {\r\n        inner[segment] = {}\r\n      }\r\n      inner = inner[segment]\r\n    }\r\n  }\r\n\r\n  const lastSegment = segments[segments.length - 1]\r\n  const oldValue = inner[lastSegment]\r\n  if (oldValue !== undefined && oldValue !== newValue) {\r\n    if (typeof oldValue !== typeof newValue) {\r\n      conflict = 'key'\r\n    } else if (oldValue !== '') {\r\n      if (newValue === '') {\r\n        newValue = oldValue\r\n      } else {\r\n        conflict = 'value'\r\n      }\r\n    }\r\n  }\r\n  duplicate = oldValue !== undefined || conflict !== false\r\n\r\n  if (options.customValueTemplate) {\r\n    inner[lastSegment] = {}\r\n\r\n    const entries = Object.entries(options.customValueTemplate)\r\n    entries.forEach((valueEntry) => {\r\n      if (valueEntry[1] === '${defaultValue}') {\r\n        inner[lastSegment][valueEntry[0]] = newValue\r\n      } else {\r\n        inner[lastSegment][valueEntry[0]] =\r\n          entry[valueEntry[1].replace(/\\${(\\w+)}/, '$1')] || ''\r\n      }\r\n    })\r\n  } else {\r\n    inner[lastSegment] = newValue\r\n  }\r\n\r\n  return { target, duplicate, conflict }\r\n}\r\n\r\n/**\r\n * Takes a `source` hash and makes sure its value\r\n * is pasted in the `target` hash, if the target\r\n * hash has the corresponding key (or if `options.keepRemoved` is true).\r\n * @returns An `{ old, new, mergeCount, pullCount, oldCount, reset, resetCount }` object.\r\n * `old` is a hash of values that have not been merged into `target`.\r\n * `new` is `target`. `mergeCount` is the number of keys merged into\r\n * `new`, `pullCount` is the number of context and plural keys added to\r\n * `new` and `oldCount` is the number of keys that were either added to `old` or\r\n * `new` (if `options.keepRemoved` is true and `target` didn't have the corresponding\r\n * key) and `reset` is the keys that were reset due to not matching default values,\r\n *  and `resetCount` which is the number of keys reset.\r\n */\r\nfunction mergeHashes(source, target, options = {}, resetValues = {}) {\r\n  let old = {}\r\n  let reset = {}\r\n  let mergeCount = 0\r\n  let pullCount = 0\r\n  let oldCount = 0\r\n  let resetCount = 0\r\n\r\n  const keepRemoved = options.keepRemoved || false\r\n  const pluralSeparator = options.pluralSeparator || '_'\r\n\r\n  for (const key in source) {\r\n    const hasNestedEntries =\r\n      typeof target[key] === 'object' && !Array.isArray(target[key])\r\n\r\n    if (hasNestedEntries) {\r\n      const nested = mergeHashes(\r\n        source[key],\r\n        target[key],\r\n        options,\r\n        resetValues[key]\r\n      )\r\n      mergeCount += nested.mergeCount\r\n      pullCount += nested.pullCount\r\n      oldCount += nested.oldCount\r\n      resetCount += nested.resetCount\r\n      if (Object.keys(nested.old).length) {\r\n        old[key] = nested.old\r\n      }\r\n      if (Object.keys(nested.reset).length) {\r\n        reset[key] = nested.reset\r\n      }\r\n    } else if (target[key] !== undefined) {\r\n      if (typeof source[key] !== 'string' && !Array.isArray(source[key])) {\r\n        old[key] = source[key]\r\n        oldCount += 1\r\n      } else {\r\n        if (\r\n          (options.resetAndFlag &&\r\n            !isPlural(key) &&\r\n            typeof source[key] === 'string' &&\r\n            source[key] !== target[key]) ||\r\n          resetValues[key]\r\n        ) {\r\n          old[key] = source[key]\r\n          oldCount += 1\r\n          reset[key] = true\r\n          resetCount += 1\r\n        } else {\r\n          target[key] = source[key]\r\n          mergeCount += 1\r\n        }\r\n      }\r\n    } else {\r\n      // support for plural in keys\r\n      const singularKey = getSingularForm(key, pluralSeparator)\r\n      const pluralMatch = key !== singularKey\r\n\r\n      // support for context in keys\r\n      const contextRegex = /_([^_]+)?$/\r\n      const contextMatch = contextRegex.test(singularKey)\r\n      const rawKey = singularKey.replace(contextRegex, '')\r\n\r\n      if (\r\n        (contextMatch && target[rawKey] !== undefined) ||\r\n        (pluralMatch &&\r\n          hasRelatedPluralKey(`${singularKey}${pluralSeparator}`, target))\r\n      ) {\r\n        target[key] = source[key]\r\n        pullCount += 1\r\n      } else {\r\n        if (keepRemoved) {\r\n          target[key] = source[key]\r\n        } else {\r\n          old[key] = source[key]\r\n        }\r\n        oldCount += 1\r\n      }\r\n    }\r\n  }\r\n\r\n  return {\r\n    old,\r\n    new: target,\r\n    mergeCount,\r\n    pullCount,\r\n    oldCount,\r\n    reset,\r\n    resetCount,\r\n  }\r\n}\r\n\r\n/**\r\n * Merge `source` into `target` by merging nested dictionaries.\r\n */\r\nfunction transferValues(source, target) {\r\n  for (const key in source) {\r\n    const sourceValue = source[key]\r\n    const targetValue = target[key]\r\n    if (\r\n      typeof sourceValue === 'object' &&\r\n      typeof targetValue === 'object' &&\r\n      !Array.isArray(sourceValue)\r\n    ) {\r\n      transferValues(sourceValue, targetValue)\r\n    } else {\r\n      target[key] = sourceValue\r\n    }\r\n  }\r\n}\r\n\r\nconst pluralSuffixes = ['zero', 'one', 'two', 'few', 'many', 'other']\r\n\r\nfunction isPlural(key) {\r\n  return pluralSuffixes.some((suffix) => key.endsWith(suffix))\r\n}\r\n\r\nfunction hasRelatedPluralKey(rawKey, source) {\r\n  return pluralSuffixes.some(\r\n    (suffix) => source[`${rawKey}${suffix}`] !== undefined\r\n  )\r\n}\r\n\r\nfunction getSingularForm(key, pluralSeparator) {\r\n  const pluralRegex = new RegExp(\r\n    `(\\\\${pluralSeparator}(?:zero|one|two|few|many|other))$`\r\n  )\r\n\r\n  return key.replace(pluralRegex, '')\r\n}\r\n\r\nfunction getPluralSuffixPosition(key) {\r\n  for (let i = 0, len = pluralSuffixes.length; i < len; i++) {\r\n    if (key.endsWith(pluralSuffixes[i])) return i\r\n  }\r\n\r\n  return -1\r\n}\r\n\r\nfunction makeDefaultSort(pluralSeparator) {\r\n  return function defaultSort(key1, key2) {\r\n    const singularKey1 = getSingularForm(key1, pluralSeparator)\r\n    const singularKey2 = getSingularForm(key2, pluralSeparator)\r\n\r\n    if (singularKey1 === singularKey2) {\r\n      return getPluralSuffixPosition(key1) - getPluralSuffixPosition(key2)\r\n    }\r\n\r\n    return singularKey1.localeCompare(singularKey2)\r\n  }\r\n}\r\n\r\nasync function esConfigLoader(filepath) {\r\n  return (await import(pathToFileURL(filepath))).default\r\n}\r\n\r\nasync function tsConfigLoader(filepath) {\r\n  const outfile = filepath + '.bundle.mjs'\r\n  await build({\r\n    absWorkingDir: process.cwd(),\r\n    entryPoints: [filepath],\r\n    outfile,\r\n    write: true,\r\n    target: ['node14.18', 'node16'],\r\n    platform: 'node',\r\n    bundle: true,\r\n    format: 'esm',\r\n    sourcemap: 'inline',\r\n    external: [\r\n      ...builtinModules,\r\n      ...builtinModules.map((mod) => 'node:' + mod),\r\n    ],\r\n  })\r\n  const config = await esConfigLoader(outfile)\r\n  rmSync(outfile)\r\n  return config\r\n}\r\n\r\nfunction yamlConfigLoader(filepath, content) {\r\n  return yaml.load(content)\r\n}\r\n\r\n// unescape common html entities\r\n// code from react-18next taken from\r\n// https://github.com/i18next/react-i18next/blob/d3247b5c232f5d8c1a154fe5dd0090ca88c82dcf/src/unescape.js\r\nfunction unescape(text) {\r\n  const matchHtmlEntity =\r\n    /&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34|nbsp|#160|copy|#169|reg|#174|hellip|#8230|#x2F|#47);/g\r\n  const htmlEntities = {\r\n    '&amp;': '&',\r\n    '&#38;': '&',\r\n    '&lt;': '<',\r\n    '&#60;': '<',\r\n    '&gt;': '>',\r\n    '&#62;': '>',\r\n    '&apos;': \"'\",\r\n    '&#39;': \"'\",\r\n    '&quot;': '\"',\r\n    '&#34;': '\"',\r\n    '&nbsp;': ' ',\r\n    '&#160;': ' ',\r\n    '&copy;': '©',\r\n    '&#169;': '©',\r\n    '&reg;': '®',\r\n    '&#174;': '®',\r\n    '&hellip;': '…',\r\n    '&#8230;': '…',\r\n    '&#x2F;': '/',\r\n    '&#47;': '/',\r\n  }\r\n\r\n  const unescapeHtmlEntity = (m) => htmlEntities[m]\r\n\r\n  return text.replace(matchHtmlEntity, unescapeHtmlEntity)\r\n}\r\n\r\nexport {\r\n  dotPathToHash,\r\n  mergeHashes,\r\n  transferValues,\r\n  hasRelatedPluralKey,\r\n  getSingularForm,\r\n  getPluralSuffixPosition,\r\n  makeDefaultSort,\r\n  esConfigLoader,\r\n  tsConfigLoader,\r\n  yamlConfigLoader,\r\n  unescape,\r\n}\r\n"],"mappings":"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"}