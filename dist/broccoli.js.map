{"version":3,"file":"broccoli.js","names":["fse","Plugin","rsvp","sort","vfs","i18nTransform","Promise","i18nextParser","_Plugin","_inherits","_super","_createSuper","inputNodes","_this","options","arguments","length","undefined","_classCallCheck","apply","_createClass","key","value","build","_this2","outputPath","resolve","reject","files","count","src","inputPaths","map","x","pipe","on","file","silent","console","log","green","path","push","outputFile","contents","message","region","trim","red","yellow","all","then","default"],"sources":["../src/broccoli.js"],"sourcesContent":["import fse from 'fs-extra'\r\nimport Plugin from 'broccoli-plugin'\r\nimport rsvp from 'rsvp'\r\nimport sort from 'gulp-sort'\r\nimport vfs from 'vinyl-fs'\r\n\r\nimport i18nTransform from './transform.js'\r\n\r\nconst Promise = rsvp.Promise\r\n\r\nexport default class i18nextParser extends Plugin {\r\n  constructor(inputNodes, options = {}) {\r\n    super(...arguments)\r\n    this.options = options\r\n  }\r\n\r\n  build() {\r\n    const outputPath = this.outputPath\r\n    return new Promise((resolve, reject) => {\r\n      const files = []\r\n      let count = 0\r\n\r\n      vfs\r\n        .src(this.inputPaths.map((x) => x + '/**/*.{js,hbs}'))\r\n        .pipe(sort())\r\n        .pipe(\r\n          new i18nTransform(this.options)\r\n            .on('reading', function (file) {\r\n              if (!this.options.silent) {\r\n                console.log('  [read]  '.green + file.path)\r\n              }\r\n              count++\r\n            })\r\n            .on('data', function (file) {\r\n              files.push(fse.outputFile(file.path, file.contents))\r\n              if (!this.options.silent) {\r\n                console.log('  [write] '.green + file.path)\r\n              }\r\n            })\r\n            .on('error', function (message, region) {\r\n              if (typeof region === 'string') {\r\n                message += ': ' + region.trim()\r\n              }\r\n              console.log('  [error] '.red + message)\r\n            })\r\n            .on('finish', function () {\r\n              if (!this.options.silent) {\r\n                console.log()\r\n                console.log('  Stats:  '.yellow + count + ' files were parsed')\r\n              }\r\n\r\n              Promise.all(files).then(() => {\r\n                resolve(files)\r\n              })\r\n            })\r\n        )\r\n    })\r\n  }\r\n}\r\n"],"mappings":"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"}